"use strict";(self.webpackChunkcliniva=self.webpackChunkcliniva||[]).push([[150],{3150:($t,k,m)=>{m.r(k),m.d(k,{AppointmentModule:()=>Vt});var f=m(6814),s=m(6223),Z=m(1896),g=m(7551),j=m(3519),v=m.n(j),Q=m(8330),T=m(8656),e=m(5879),J=m(9741),I=m(2670),O=m(1421),x=m(4414),A=m(3680),D=m(2296),q=m(9488),_=m(8034),h=m(4170),M=m(617),U=m(2032),F=m(8525);function L(t,a){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id_medico),e.xp6(1),e.hij(" ",o.nombre+" "+o.apellidos," ")}}function G(t,a){1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&t&&(e.xp6(1),e.Oqu("Debe seleccionar un medico"))}function H(t,a){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o),e.xp6(1),e.hij(" ",o.nombre+" "+o.apellidos," ")}}function z(t,a){1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&t&&(e.xp6(1),e.Oqu("Debe seleccionar un paciente"))}function X(t,a){1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&t&&(e.xp6(1),e.Oqu("Debe seleccionar una fecha"))}function W(t,a){if(1&t&&(e.TgZ(0,"mat-button-toggle",29),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.value)("disabled",o.isDisable),e.xp6(1),e.hij(" ",o.name," ")}}function K(t,a){1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&t&&(e.xp6(1),e.Oqu("Seleccionar un horario"))}function ee(t,a){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o),e.xp6(1),e.hij(" ",o," ")}}function te(t,a){1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&t&&(e.xp6(1),e.Oqu("Debe seleccionar el motivo de la consulta"))}const oe=function(){return[]};let ie=(()=>{class t{constructor(o,i,n,l,c,d,r){this.fb=o,this.patientsService=i,this.appoinmentsService=n,this.configurationService=l,this.scheduleService=c,this.doctorsService=d,this.router=r,this.patients=[],this.medics=[],this.selectedMedicId=0,this.horariosLibres=[],this.motivos=[],this.newAppoinmentForm=this.fb.group({paciente:[,s.kI.required],medico:[,s.kI.required],fechaCita:[,s.kI.required],horario:[,s.kI.required],motivoConsulta:[,s.kI.required]}),this.myFilter=u=>{const C=(u||new Date).getDay();return 0!==C&&6!==C&&u>new Date}}ngOnInit(){this.configurationService.getMotivoConsulta().subscribe(o=>{this.motivos=o.motivoConsulta.map(i=>i.motivo_consulta)}),this.newAppoinmentForm.get("paciente")?.disable(),this.doctorsService.getAllDoctorss().subscribe(o=>{this.medics=o.medicos})}findPatients(o){this.selectedMedicId=o.value,this.patientsService.getAllPatients(this.selectedMedicId).subscribe(i=>{console.log(i),this.newAppoinmentForm.get("paciente")?.enable(),this.patients=i.paciente})}saveAppoinment(){if(!this.newAppoinmentForm.valid)return void this.newAppoinmentForm.markAllAsTouched();const o=Q.z.coerce.date();let i=new Date(this.newAppoinmentForm.get("fechaCita")?.value);if(!o.safeParse(i).success)return void v().fire({icon:"error",title:"Error fecha invalida"});let n=i.setHours(this.newAppoinmentForm.get("horario")?.value),l=new Date(new Date(n).toISOString()),c=6e4*l.getTimezoneOffset(),d=new Date(l.getTime()-c);console.log(d.toISOString()),this.newAppoinmentForm.get("fechaCita")?.setValue(d.toISOString()),console.log(this.newAppoinmentForm.value),this.appoinmentsService.addAppoinment({fecha_cita:this.newAppoinmentForm.value.fechaCita,id_medico:this.newAppoinmentForm.value.medico,id_paciente:this.newAppoinmentForm.value.paciente.id_paciente,motivo_consulta:this.newAppoinmentForm.value.motivoConsulta}).subscribe({complete:()=>{this.newAppoinmentForm.reset(),v().fire("Se agendo la cita con exito"),this.router.navigateByUrl("admin/appointment/viewAppointment")},error:u=>{console.log(u),v().fire({icon:"error",title:"Error al registrar la cita",text:u.msg})}})}onDateChange(o){let i=[];this.horariosLibres=[],this.scheduleService.getAllSchedule().subscribe({complete:()=>{},next:n=>{i=n,console.log(i,"horarios"),this.appoinmentsService.getTakenSlots(new Date(o.value).toISOString()).subscribe(l=>{let c=l.arrayTakenSlots.map(r=>new Date(r).getUTCHours());i.horarios.map(r=>r.horario).forEach(r=>{for(let u=0;u<c.length;u++)if(r===c[u])return void this.horariosLibres.push({value:r,name:`${r}:00 - ${r+1}:00`,isDisable:!0});this.horariosLibres.push({value:r,name:`${r}:00 - ${r+1}:00`,isDisable:!1})}),console.log(this.horariosLibres)})}})}getAllAppoinmentsSlots(){}campoEsValido(o){return this.newAppoinmentForm.controls[o].errors&&this.newAppoinmentForm.controls[o].touched}toggleChange(o){const i=o.source;i&&o.value.some(n=>n==i.value)&&(i.buttonToggleGroup.value=[i.value])}static#e=this.\u0275fac=function(i){return new(i||t)(e.Y36(s.qu),e.Y36(J.$),e.Y36(g.O),e.Y36(I.e),e.Y36(O.n),e.Y36(T.e),e.Y36(Z.F0))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-bookappointment"]],features:[e._Bn([g.O,T.e])],decls:54,vars:17,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[3,"title","items","active_item"],[3,"formGroup"],[1,"row"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12"],[1,"card"],[1,"header"],[1,"body"],[1,"example-container"],["appearance","outline",1,"col-4"],["formControlName","medico",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["formControlName","paciente"],[1,"col-4"],[1,"example-full-width"],["matInput","","formControlName","fechaCita",3,"matDatepickerFilter","matDatepicker","dateInput"],["matSuffix","",3,"for"],["picker",""],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12","mb-3"],["formControlName","horario","name","horarios","aria-label","horarios"],["style","width: 6.2rem;",3,"value","disabled",4,"ngFor","ngForOf"],["formControlName","motivoConsulta"],[1,"row","align-self-end"],[1,"mb-3","me-3"],["type","button","mat-fab","","extended","","color","primary",3,"click"],[3,"value"],[2,"width","6.2rem",3,"value","disabled"]],template:function(i,n){if(1&i&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2),e._UZ(3,"app-breadcrumb",3),e.qZA(),e.TgZ(4,"form",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"h2"),e._uU(10,"Agendar Nueva Cita"),e.qZA()(),e.TgZ(11,"div",9)(12,"div",10)(13,"div",5)(14,"mat-form-field",11)(15,"mat-label"),e._uU(16,"Medicos"),e.qZA(),e.TgZ(17,"mat-select",12),e.NdJ("selectionChange",function(c){return n.findPatients(c)}),e.YNc(18,L,2,2,"mat-option",13),e.qZA(),e.YNc(19,G,2,1,"mat-error",14),e.qZA(),e.TgZ(20,"mat-form-field",11)(21,"mat-label"),e._uU(22,"Paciente"),e.qZA(),e.TgZ(23,"mat-select",15),e.YNc(24,H,2,2,"mat-option",13),e.qZA(),e.YNc(25,z,2,1,"mat-error",14),e.qZA(),e.TgZ(26,"div",16)(27,"mat-form-field",17)(28,"mat-label"),e._uU(29,"Fecha Cita"),e.qZA(),e.TgZ(30,"input",18),e.NdJ("dateInput",function(c){return n.onDateChange(c)}),e.qZA(),e._UZ(31,"mat-datepicker-toggle",19)(32,"mat-datepicker",null,20),e.YNc(34,X,2,1,"mat-error",14),e.qZA()()(),e.TgZ(35,"div",5)(36,"label"),e._uU(37,"Horario de la Cita:"),e.qZA(),e.TgZ(38,"div",21)(39,"mat-button-toggle-group",22),e.YNc(40,W,2,3,"mat-button-toggle",23),e.qZA(),e.YNc(41,K,2,1,"mat-error",14),e.qZA()(),e.TgZ(42,"mat-form-field",11)(43,"mat-label"),e._uU(44,"Motivo Consulta"),e.qZA(),e.TgZ(45,"mat-select",24),e.YNc(46,ee,2,2,"mat-option",13),e.qZA(),e.YNc(47,te,2,1,"mat-error",14),e.qZA()()(),e.TgZ(48,"div",25)(49,"div",26)(50,"button",27),e.NdJ("click",function(){return n.saveAppoinment()}),e.TgZ(51,"mat-icon"),e._uU(52,"done"),e.qZA(),e._uU(53," Agendar Cita "),e.qZA()()()()()()()()()),2&i){const l=e.MAs(33);e.xp6(3),e.Q6J("title","Citas")("items",e.DdM(16,oe))("active_item","Agendar Nueva Cita"),e.xp6(1),e.Q6J("formGroup",n.newAppoinmentForm),e.xp6(14),e.Q6J("ngForOf",n.medics),e.xp6(1),e.Q6J("ngIf",n.campoEsValido("medico")),e.xp6(5),e.Q6J("ngForOf",n.patients),e.xp6(1),e.Q6J("ngIf",n.campoEsValido("paciente")),e.xp6(5),e.Q6J("matDatepickerFilter",n.myFilter)("matDatepicker",l),e.xp6(1),e.Q6J("for",l),e.xp6(3),e.Q6J("ngIf",n.campoEsValido("fechaCita")),e.xp6(6),e.Q6J("ngForOf",n.horariosLibres),e.xp6(1),e.Q6J("ngIf",n.campoEsValido("horario")),e.xp6(5),e.Q6J("ngForOf",n.motivos),e.xp6(1),e.Q6J("ngIf",n.campoEsValido("motivoConsulta"))}},dependencies:[f.sg,f.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,x.L,A.ey,D.cs,q.A9,q.Yi,_.Mq,_.hl,_.nW,h.KE,h.hX,h.TO,h.R9,M.Hw,U.Nt,F.gD]})}return t})();var b=m(1476),w=m(3566),E=m(8337),B=m(2589),R=m(7988),p=m(5313),S=m(2537),y=m(9862),V=m(9347),$=m(2939),N=m(5940),Y=m(4897);const ae=["filter"];function ne(t,a){1&t&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Id "),e.qZA())}function le(t,a){if(1&t&&(e.TgZ(0,"mat-cell"),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.xp6(1),e.Oqu(o.id)}}function re(t,a){1&t&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Nombre Paciente "),e.qZA())}function se(t,a){if(1&t&&(e.TgZ(0,"mat-cell")(1,"span",32),e._uU(2,"Patient Name:"),e.qZA(),e._uU(3),e.qZA()),2&t){const o=a.$implicit;e.xp6(3),e.hij(" ",o.Paciente.nombre+" "+o.Paciente.apellidos," ")}}function me(t,a){1&t&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Fecha y Hora "),e.qZA())}function ce(t,a){if(1&t&&(e.TgZ(0,"mat-cell")(1,"span",32),e._uU(2,"Date & Time:"),e.qZA(),e._uU(3),e.ALo(4,"CustomDateTablePipe"),e.qZA()),2&t){const o=a.$implicit;e.xp6(3),e.hij(" ",e.lcZ(4,1,o.fecha_cita)," ")}}function pe(t,a){1&t&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Medico "),e.qZA())}function ue(t,a){if(1&t&&(e.TgZ(0,"mat-cell")(1,"span",32),e._uU(2,"Medico:"),e.qZA(),e._uU(3),e.qZA()),2&t){const o=a.$implicit;e.xp6(3),e.hij(" ",o.Medico.nombre+" "+o.Medico.apellidos," ")}}function de(t,a){1&t&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Celular "),e.qZA())}function he(t,a){if(1&t&&(e.TgZ(0,"mat-cell")(1,"span",32),e._uU(2,"Mobile:"),e.qZA(),e._uU(3),e.qZA()),2&t){const o=a.$implicit;e.xp6(3),e.hij(" ",o.Paciente.telefono," ")}}function fe(t,a){1&t&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Correo "),e.qZA())}function _e(t,a){if(1&t&&(e.TgZ(0,"mat-cell")(1,"span",32),e._uU(2,"Email:"),e.qZA(),e._uU(3),e.qZA()),2&t){const o=a.$implicit;e.xp6(3),e.hij(" ",o.Paciente.correo," ")}}function ge(t,a){1&t&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Address "),e.qZA())}function ve(t,a){if(1&t&&(e.TgZ(0,"mat-cell",33)(1,"span",32),e._uU(2,"Address:"),e.qZA(),e._uU(3),e.qZA()),2&t){const o=a.$implicit;e.xp6(3),e.hij("",o.Paciente.calle_y_numero," ")}}function Ae(t,a){1&t&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Estatus "),e.qZA())}function Ze(t,a){if(1&t&&(e.TgZ(0,"mat-cell",33)(1,"span",32),e._uU(2,"Estatus:"),e.qZA(),e.TgZ(3,"button",34),e._uU(4),e.qZA()()),2&t){const o=a.$implicit,i=e.oxw();e.xp6(3),e.Q6J("ngClass",i.getStatus(o.estatus)),e.xp6(1),e.hij(" ",o.estatus," ")}}function Te(t,a){1&t&&e._UZ(0,"mat-header-row")}function Ce(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"mat-row",35),e.NdJ("click",function(){const l=e.CHM(o).$implicit,c=e.oxw();return e.KtG(c.redirect(l.id_cita))}),e.qZA()}2&t&&e.Udp("cursor","pointer")}function be(t,a){1&t&&(e.TgZ(0,"div",36),e._UZ(1,"mat-progress-spinner",37),e.qZA()),2&t&&(e.xp6(1),e.Q6J("diameter",40))}function xe(t,a){if(1&t&&(e.TgZ(0,"div",38),e._uU(1," No results "),e.qZA()),2&t){const o=e.oxw();e.Udp("display",0===o.datosFuente.length?"":"none")}}const De=function(){return[]},we=function(){return[5,10,25,100]};let qe=(()=>{class t extends B.n{constructor(o,i,n,l,c){super(),this.httpClient=o,this.dialog=i,this.appointmentsService=n,this.snackBar=l,this.router=c,this.filterToggle=!1,this.displayedColumns=["name","dateTime","medic","email","mobile","estatus"],this.currentDate=(new Date).toISOString(),this.estatus=1,this.dataSource=new p.by,this.datosFuente=[],this.selection=new E.Ov(!0,[]),this.contextMenuPosition={x:"0px",y:"0px"},new p.by([])}ngOnInit(){this.loadData()}refresh(){this.loadData()}addNew(){let o;o="true"===localStorage.getItem("isRtl")?"rtl":"ltr";const i=this.dialog.open(S.U,{data:{appointments:this.appointments,action:"add"},direction:o});this.subs.sink=i.afterClosed().subscribe(n=>{1===n&&(this.exampleDatabase?.dataChange.value.unshift(this.appointmentsService.getDialogData()),this.refreshTable(),this.showNotification("snackbar-success","Add Record Successfully...!!!","bottom","center"))})}detailsCall(o){let i;i="true"===localStorage.getItem("isRtl")?"rtl":"ltr",this.dialog.open(S.U,{data:{appointments:o,action:"details"},direction:i,height:"71%",width:"35%"})}toggleStar(o){console.log(o)}refreshTable(){this.paginator._changePageSize(this.paginator.pageSize)}getStatus(o){return"En espera"==o?"mat-primary":"En curso"==o?"mat-success":"mat-finish"}loadData(){this.appointmentsService.getAllAppoinmentsAdmin().subscribe(o=>{this.datosFuente=o.citasActuales,this.dataSource=new p.by(this.datosFuente),this.datosFuente.forEach(i=>{i.fecha_cita=new Date(i.fecha_cita).toLocaleString()}),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,console.log(this.datosFuente,"datosFuente")})}redirect(o){this.router.navigateByUrl("admin/appointment/edit-appointment",{state:{idCita:o}})}showNotification(o,i,n,l){this.snackBar.open(i,"",{duration:2e3,verticalPosition:n,horizontalPosition:l,panelClass:o})}static#e=this.\u0275fac=function(i){return new(i||t)(e.Y36(y.eN),e.Y36(V.uw),e.Y36(g.O),e.Y36($.ux),e.Y36(Z.F0))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-viewappointment"]],viewQuery:function(i,n){if(1&i&&(e.Gf(b.NW,7),e.Gf(w.YE,7),e.Gf(ae,7),e.Gf(R.p6,5)),2&i){let l;e.iGM(l=e.CRH())&&(n.paginator=l.first),e.iGM(l=e.CRH())&&(n.sort=l.first),e.iGM(l=e.CRH())&&(n.filter=l.first),e.iGM(l=e.CRH())&&(n.contextMenu=l.first)}},features:[e._Bn([{provide:A.Ad,useValue:"en-GB"},g.O]),e.qOj],decls:47,vars:14,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[3,"title","items","active_item"],[1,"row"],[1,"col-lg-12","col-md-12","col-sm-12","col-xs-12"],[1,"card"],[1,"materialTableHeader"],[1,"left"],[1,"header-buttons-left","ms-0"],[1,"tbl-title"],[1,"body","overflow-auto"],[1,"responsive_table"],["matSort","",1,"mat-cell",3,"dataSource"],["table",""],["matColumnDef","id"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","name"],["matColumnDef","dateTime"],["matColumnDef","medic"],["matColumnDef","mobile"],["matColumnDef","email"],["matColumnDef","address"],["class","column-nowrap",4,"matCellDef"],["matColumnDef","estatus"],[4,"matHeaderRowDef"],["matRipple","",3,"cursor","click",4,"matRowDef","matRowDefColumns"],["class","tbl-spinner",4,"ngIf"],["class","no-results",3,"display",4,"ngIf"],[3,"length","pageIndex","pageSize","pageSizeOptions"],["paginator",""],[1,"mobile-label"],[1,"column-nowrap"],["mat-raised-button","",3,"ngClass"],["matRipple","",3,"click"],[1,"tbl-spinner"],["color","primary","mode","indeterminate",3,"diameter"],[1,"no-results"]],template:function(i,n){1&i&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2),e._UZ(3,"app-breadcrumb",3),e.qZA(),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"ul",9)(10,"li",10)(11,"h2"),e._uU(12,"Citas"),e.qZA()()()()(),e.TgZ(13,"div",11)(14,"div",12)(15,"mat-table",13,14),e.ynx(17,15),e.YNc(18,ne,2,0,"mat-header-cell",16),e.YNc(19,le,2,1,"mat-cell",17),e.BQk(),e.ynx(20,18),e.YNc(21,re,2,0,"mat-header-cell",16),e.YNc(22,se,4,1,"mat-cell",17),e.BQk(),e.ynx(23,19),e.YNc(24,me,2,0,"mat-header-cell",16),e.YNc(25,ce,5,3,"mat-cell",17),e.BQk(),e.ynx(26,20),e.YNc(27,pe,2,0,"mat-header-cell",16),e.YNc(28,ue,4,1,"mat-cell",17),e.BQk(),e.ynx(29,21),e.YNc(30,de,2,0,"mat-header-cell",16),e.YNc(31,he,4,1,"mat-cell",17),e.BQk(),e.ynx(32,22),e.YNc(33,fe,2,0,"mat-header-cell",16),e.YNc(34,_e,4,1,"mat-cell",17),e.BQk(),e.ynx(35,23),e.YNc(36,ge,2,0,"mat-header-cell",16),e.YNc(37,ve,4,1,"mat-cell",24),e.BQk(),e.ynx(38,25),e.YNc(39,Ae,2,0,"mat-header-cell",16),e.YNc(40,Ze,5,2,"mat-cell",24),e.BQk(),e.YNc(41,Te,1,0,"mat-header-row",26),e.YNc(42,Ce,1,2,"mat-row",27),e.qZA(),e.YNc(43,be,2,1,"div",28),e.YNc(44,xe,2,2,"div",29),e._UZ(45,"mat-paginator",30,31),e.qZA()()()()()()()),2&i&&(e.xp6(3),e.Q6J("title","Citas")("items",e.DdM(12,De))("active_item","Citas Actuales"),e.xp6(12),e.Q6J("dataSource",n.dataSource),e.xp6(26),e.Q6J("matHeaderRowDef",n.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",n.displayedColumns),e.xp6(1),e.Q6J("ngIf",null==n.exampleDatabase?null:n.exampleDatabase.isTblLoading),e.xp6(1),e.Q6J("ngIf",!(null!=n.exampleDatabase&&n.exampleDatabase.isTblLoading)),e.xp6(1),e.Q6J("length",n.datosFuente.length)("pageIndex",0)("pageSize",10)("pageSizeOptions",e.DdM(13,we)))},dependencies:[f.mk,f.O5,x.L,D.lW,b.NW,N.Ou,A.wG,w.YE,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,Y.m]})}return t})();function Ue(t,a){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id_medico),e.xp6(1),e.hij(" ",o.nombre+" "+o.apellidos," ")}}function Fe(t,a){1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&t&&(e.xp6(1),e.Oqu("Debe seleccionar un medico"))}function Se(t,a){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id_paciente),e.xp6(1),e.hij(" ",o.nombre+" "+o.apellidos," ")}}function ye(t,a){1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&t&&(e.xp6(1),e.Oqu("Debe seleccionar un paciente"))}function Ne(t,a){1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&t&&(e.xp6(1),e.Oqu("Debe seleccionar una fecha"))}function Ye(t,a){if(1&t&&(e.TgZ(0,"mat-button-toggle",29),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.value)("disabled",o.isDisable),e.xp6(1),e.hij(" ",o.name," ")}}function ke(t,a){1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&t&&(e.xp6(1),e.Oqu("Seleccionar un horario"))}function Qe(t,a){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o),e.xp6(1),e.hij(" ",o," ")}}function Je(t,a){1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&t&&(e.xp6(1),e.Oqu("Debe seleccionar el motivo de la consulta"))}const Ie=function(){return[]};let Oe=(()=>{class t{constructor(o,i,n,l,c,d){this.fb=o,this.router=i,this.appoinmentsService=n,this.scheduleService=l,this.patientsService=c,this.doctorsService=d,this.patients=[],this.medics=[],this.idMedico=0,this.idPaciente=0,this.selectedMedicId=0,this.horariosLibres=[],this.motivos=["Consulta Medica","Seguimiento"],this.minDate=new Date,this.isDisabled=!0,this.appoinmentForm=this.fb.group({cita:[,s.kI.required],paciente:[,s.kI.required],medico:[,s.kI.required],fechaCita:[,s.kI.required],horario:[,s.kI.required],motivoConsulta:[,s.kI.required]}),this.myFilter=r=>{const u=(r||new Date).getDay();return 0!==u&&6!==u},this.state=this.router.getCurrentNavigation()?.extras.state}ngOnInit(){if(null==this.state)return void this.router.navigateByUrl("admin/appointment/viewAppointment");this.appoinmentForm.get("paciente")?.disable({onlySelf:!0}),this.appoinmentForm.get("medico")?.disable({onlySelf:!0}),this.appoinmentsService.getAppointmentById(this.state.idCita).subscribe(c=>{console.log(c.cita),this.loadData(c.cita)});const i=(new Date).getFullYear(),n=(new Date).getMonth(),l=(new Date).getDate();this.minDate=new Date(i,n,l-1),console.log(this.state)}loadData(o){let i=new Date(o.fecha_cita),n=6e4*i.getTimezoneOffset(),l=new Date(i.getTime()+n);console.log(l.getHours(),"hora");let c=l.getHours();this.loadTakenSlots(o.fecha_cita),this.idMedico=o.id_medico,this.idPaciente=o.id_paciente,this.doctorsService.getAllDoctorss().subscribe(r=>this.medics=r.medicos),this.patientsService.getAllPatients(this.idMedico).subscribe(r=>this.patients=r.paciente),console.log(this.patients),this.appoinmentForm.get("cita")?.setValue(o.id_cita),this.appoinmentForm.get("paciente")?.setValue(this.idPaciente),this.appoinmentForm.get("medico")?.setValue(this.idMedico),this.appoinmentForm.get("fechaCita")?.setValue(o.fecha_cita),this.appoinmentForm.get("horario")?.setValue(c),this.appoinmentForm.get("motivoConsulta")?.setValue(o.motivo_consulta),this.appoinmentBackup={fechaCita:o.fecha_cita,horario:c,motivoConsulta:o.motivo_consulta}}editAppoinment(){if(!this.appoinmentForm.valid)return void this.appoinmentForm.markAllAsTouched();if(this.appoinmentBackup.fechaCita==this.appoinmentForm.get("fechaCita")?.value&&this.appoinmentBackup.horario==this.appoinmentForm.get("horario")?.value&&this.appoinmentBackup.motivoConsulta==this.appoinmentForm.get("motivoConsulta")?.value)return void v().fire("No hay cambios registrados");this.appoinmentForm.get("paciente"),this.appoinmentForm.get("medico");const o=Q.z.coerce.date();let i=new Date(this.appoinmentForm.get("fechaCita")?.value);if(!o.safeParse(i).success)return void v().fire({icon:"error",title:"Error fecha invalida"});let n=i.setHours(this.appoinmentForm.get("horario")?.value),l=new Date(new Date(n).toISOString()),c=6e4*l.getTimezoneOffset(),d=new Date(l.getTime()-c);console.log(d.toISOString()),this.appoinmentForm.get("fechaCita")?.setValue(d.toISOString()),console.log(this.appoinmentForm.value);let r={fecha_cita:this.appoinmentForm.value.fechaCita,id_medico:this.appoinmentForm.getRawValue().medico,id_paciente:this.appoinmentForm.getRawValue().paciente.id_paciente,motivo_consulta:this.appoinmentForm.value.motivoConsulta},u=this.appoinmentForm.get("cita")?.value;this.appoinmentsService.updateAppointmentDate(r,u).subscribe({complete:()=>{this.appoinmentForm.reset(),v().fire("Se agendo la cita con exito"),this.router.navigateByUrl("admin/appointment/viewAppointment")},error:C=>{console.log(C),v().fire({icon:"error",title:"Error al registrar la cita",text:C.msg})}})}campoEsValido(o){return this.appoinmentForm.controls[o].errors&&this.appoinmentForm.controls[o].touched}redirect(){this.router.navigateByUrl("admin/appointment/viewAppointment")}onDateChange(o){let i=[];this.horariosLibres=[],this.scheduleService.getAllSchedule().subscribe({next:n=>{i=n,console.log(i,"horarios"),this.appoinmentsService.getTakenSlots(new Date(o.value).toISOString()).subscribe(l=>{let c=l.arrayTakenSlots.map(r=>new Date(r).getUTCHours());i.horarios.map(r=>r.horario).forEach(r=>{for(let u=0;u<c.length;u++)if(r===c[u])return void this.horariosLibres.push({value:r,name:`${r}:00 - ${r+1}:00`,isDisable:!0});this.horariosLibres.push({value:r,name:`${r}:00 - ${r+1}:00`,isDisable:!1})}),console.log(this.horariosLibres)})}})}loadTakenSlots(o){let i=[];this.horariosLibres=[],this.scheduleService.getAllSchedule().subscribe({next:n=>{i=n,console.log(i,"horarios"),this.appoinmentsService.getTakenSlots(o).subscribe(l=>{let c=l.arrayTakenSlots.map(r=>new Date(r).getUTCHours());i.horarios.map(r=>r.horario).forEach(r=>{for(let u=0;u<c.length;u++)if(r===c[u])return void this.horariosLibres.push({value:r,name:`${r}:00 - ${r+1}:00`,isDisable:!0});this.horariosLibres.push({value:r,name:`${r}:00 - ${r+1}:00`,isDisable:!1})}),console.log(this.horariosLibres)})}})}static#e=this.\u0275fac=function(i){return new(i||t)(e.Y36(s.qu),e.Y36(Z.F0),e.Y36(g.O),e.Y36(O.n),e.Y36(J.$),e.Y36(T.e))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-editappointment"]],features:[e._Bn([g.O,T.e])],decls:54,vars:18,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[3,"title","items","active_item"],[3,"formGroup"],[1,"row"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12"],[1,"card"],[1,"header"],[1,"body"],[1,"example-container"],["appearance","outline",1,"col-4"],["formControlName","medico"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["formControlName","paciente"],[1,"col-4"],[1,"example-full-width"],["matInput","","formControlName","fechaCita",3,"matDatepickerFilter","min","matDatepicker","dateInput"],["matSuffix","",3,"for"],["picker",""],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12","mb-3"],["formControlName","horario","name","horarios","aria-label","horarios"],["style","width: 6.2rem;",3,"value","disabled",4,"ngFor","ngForOf"],["formControlName","motivoConsulta"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12","mb-3","ms-3"],["mat-raised-button","","color","primary",1,"btn-space",3,"click"],["type","button","mat-raised-button","","color","primary",3,"click"],[3,"value"],[2,"width","6.2rem",3,"value","disabled"]],template:function(i,n){if(1&i&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2),e._UZ(3,"app-breadcrumb",3),e.qZA(),e.TgZ(4,"form",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"h2"),e._uU(10,"Editar Cita"),e.qZA()(),e.TgZ(11,"div",9)(12,"div",10)(13,"div",5)(14,"mat-form-field",11)(15,"mat-label"),e._uU(16,"Medicos"),e.qZA(),e.TgZ(17,"mat-select",12),e.YNc(18,Ue,2,2,"mat-option",13),e.qZA(),e.YNc(19,Fe,2,1,"mat-error",14),e.qZA(),e.TgZ(20,"mat-form-field",11)(21,"mat-label"),e._uU(22,"Paciente"),e.qZA(),e.TgZ(23,"mat-select",15),e.YNc(24,Se,2,2,"mat-option",13),e.qZA(),e.YNc(25,ye,2,1,"mat-error",14),e.qZA(),e.TgZ(26,"div",16)(27,"mat-form-field",17)(28,"mat-label"),e._uU(29,"Fecha Cita"),e.qZA(),e.TgZ(30,"input",18),e.NdJ("dateInput",function(c){return n.onDateChange(c)}),e.qZA(),e._UZ(31,"mat-datepicker-toggle",19)(32,"mat-datepicker",null,20),e.YNc(34,Ne,2,1,"mat-error",14),e.qZA()()(),e.TgZ(35,"div",5)(36,"label"),e._uU(37,"Horario de la Cita:"),e.qZA(),e.TgZ(38,"div",21)(39,"mat-button-toggle-group",22),e.YNc(40,Ye,2,3,"mat-button-toggle",23),e.qZA(),e.YNc(41,ke,2,1,"mat-error",14),e.qZA()(),e.TgZ(42,"mat-form-field",11)(43,"mat-label"),e._uU(44,"Motivo Consulta"),e.qZA(),e.TgZ(45,"mat-select",24),e.YNc(46,Qe,2,2,"mat-option",13),e.qZA(),e.YNc(47,Je,2,1,"mat-error",14),e.qZA()()(),e.TgZ(48,"div",5)(49,"div",25)(50,"button",26),e.NdJ("click",function(){return n.editAppoinment()}),e._uU(51,"Guardar Cambios"),e.qZA(),e.TgZ(52,"button",27),e.NdJ("click",function(){return n.redirect()}),e._uU(53,"Cancelar"),e.qZA()()()()()()()()()),2&i){const l=e.MAs(33);e.xp6(3),e.Q6J("title","Citas")("items",e.DdM(17,Ie))("active_item","Editar Cita"),e.xp6(1),e.Q6J("formGroup",n.appoinmentForm),e.xp6(14),e.Q6J("ngForOf",n.medics),e.xp6(1),e.Q6J("ngIf",n.campoEsValido("medico")),e.xp6(5),e.Q6J("ngForOf",n.patients),e.xp6(1),e.Q6J("ngIf",n.campoEsValido("paciente")),e.xp6(5),e.Q6J("matDatepickerFilter",n.myFilter)("min",n.minDate)("matDatepicker",l),e.xp6(1),e.Q6J("for",l),e.xp6(3),e.Q6J("ngIf",n.campoEsValido("fechaCita")),e.xp6(6),e.Q6J("ngForOf",n.horariosLibres),e.xp6(1),e.Q6J("ngIf",n.campoEsValido("horario")),e.xp6(5),e.Q6J("ngForOf",n.motivos),e.xp6(1),e.Q6J("ngIf",n.campoEsValido("motivoConsulta"))}},dependencies:[f.sg,f.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,x.L,A.ey,D.lW,q.A9,q.Yi,_.Mq,_.hl,_.nW,h.KE,h.hX,h.TO,h.R9,U.Nt,F.gD]})}return t})();var Me=m(9182);function Ee(t,a){if(1&t&&(e.TgZ(0,"mat-option",20),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id_medico),e.xp6(1),e.hij(" ",o.nombre+" "+o.apellidos," ")}}function Be(t,a){1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&t&&(e.xp6(1),e.Oqu("Debe seleccionar un medico"))}function Re(t,a){1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&t&&(e.xp6(1),e.Oqu("Debe seleccionar una fecha"))}function Ve(t,a){1&t&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Id "),e.qZA())}function $e(t,a){if(1&t&&(e.TgZ(0,"mat-cell"),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.xp6(1),e.Oqu(o.id)}}function Pe(t,a){1&t&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Nombre Paciente "),e.qZA())}function je(t,a){if(1&t&&(e.TgZ(0,"mat-cell")(1,"span",48),e._uU(2,"Patient Name:"),e.qZA(),e._uU(3),e.qZA()),2&t){const o=a.$implicit;e.xp6(3),e.hij(" ",o.Paciente.nombre+" "+o.Paciente.apellidos," ")}}function Le(t,a){1&t&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Fecha y Hora "),e.qZA())}function Ge(t,a){if(1&t&&(e.TgZ(0,"mat-cell")(1,"span",48),e._uU(2,"Date & Time:"),e.qZA(),e._uU(3),e.ALo(4,"CustomDateTablePipe"),e.qZA()),2&t){const o=a.$implicit;e.xp6(3),e.hij(" ",e.lcZ(4,1,o.fecha_cita)," ")}}function He(t,a){1&t&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Medico "),e.qZA())}function ze(t,a){if(1&t&&(e.TgZ(0,"mat-cell")(1,"span",48),e._uU(2,"Medico:"),e.qZA(),e._uU(3),e.qZA()),2&t){const o=a.$implicit;e.xp6(3),e.hij(" ",o.Medico.nombre+" "+o.Medico.apellidos," ")}}function Xe(t,a){1&t&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Celular "),e.qZA())}function We(t,a){if(1&t&&(e.TgZ(0,"mat-cell")(1,"span",48),e._uU(2,"Mobile:"),e.qZA(),e._uU(3),e.qZA()),2&t){const o=a.$implicit;e.xp6(3),e.hij(" ",o.Paciente.telefono," ")}}function Ke(t,a){1&t&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Correo "),e.qZA())}function et(t,a){if(1&t&&(e.TgZ(0,"mat-cell")(1,"span",48),e._uU(2,"Email:"),e.qZA(),e._uU(3),e.qZA()),2&t){const o=a.$implicit;e.xp6(3),e.hij(" ",o.Paciente.correo," ")}}function tt(t,a){1&t&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Address "),e.qZA())}function ot(t,a){if(1&t&&(e.TgZ(0,"mat-cell",49)(1,"span",48),e._uU(2,"Address:"),e.qZA(),e._uU(3),e.qZA()),2&t){const o=a.$implicit;e.xp6(3),e.hij("",o.Paciente.calle_y_numero," ")}}function it(t,a){1&t&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Estatus "),e.qZA())}function at(t,a){if(1&t&&(e.TgZ(0,"mat-cell",49)(1,"span",48),e._uU(2,"Estatus:"),e.qZA(),e.TgZ(3,"button",50),e._uU(4),e.qZA()()),2&t){const o=a.$implicit,i=e.oxw(2);e.xp6(3),e.Q6J("ngClass",i.getStatus(o.estatus)),e.xp6(1),e.hij(" ",o.estatus," ")}}function nt(t,a){1&t&&e._UZ(0,"mat-header-row")}function lt(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"mat-row",51),e.NdJ("click",function(){const l=e.CHM(o).$implicit,c=e.oxw(2);return e.KtG(c.redirect(l.id_cita))}),e.qZA()}2&t&&e.Udp("cursor","pointer")}function rt(t,a){1&t&&(e.TgZ(0,"div",52),e._UZ(1,"mat-progress-spinner",53),e.qZA()),2&t&&(e.xp6(1),e.Q6J("diameter",40))}function st(t,a){if(1&t&&(e.TgZ(0,"div",54),e._uU(1," No results "),e.qZA()),2&t){const o=e.oxw(2);e.Udp("display",0===o.datosFuente.length?"":"none")}}const mt=function(){return[5,10,25,100]};function ct(t,a){if(1&t&&(e.TgZ(0,"div",4)(1,"div",21)(2,"div",5)(3,"div",22)(4,"div",23)(5,"ul",24)(6,"li",25)(7,"h2"),e._uU(8,"Citas"),e.qZA()()()(),e._UZ(9,"div",26),e.qZA(),e.TgZ(10,"div",27)(11,"div",28)(12,"mat-table",29,30),e.ynx(14,31),e.YNc(15,Ve,2,0,"mat-header-cell",32),e.YNc(16,$e,2,1,"mat-cell",33),e.BQk(),e.ynx(17,34),e.YNc(18,Pe,2,0,"mat-header-cell",32),e.YNc(19,je,4,1,"mat-cell",33),e.BQk(),e.ynx(20,35),e.YNc(21,Le,2,0,"mat-header-cell",32),e.YNc(22,Ge,5,3,"mat-cell",33),e.BQk(),e.ynx(23,36),e.YNc(24,He,2,0,"mat-header-cell",32),e.YNc(25,ze,4,1,"mat-cell",33),e.BQk(),e.ynx(26,37),e.YNc(27,Xe,2,0,"mat-header-cell",32),e.YNc(28,We,4,1,"mat-cell",33),e.BQk(),e.ynx(29,38),e.YNc(30,Ke,2,0,"mat-header-cell",32),e.YNc(31,et,4,1,"mat-cell",33),e.BQk(),e.ynx(32,39),e.YNc(33,tt,2,0,"mat-header-cell",32),e.YNc(34,ot,4,1,"mat-cell",40),e.BQk(),e.ynx(35,41),e.YNc(36,it,2,0,"mat-header-cell",32),e.YNc(37,at,5,2,"mat-cell",40),e.BQk(),e.YNc(38,nt,1,0,"mat-header-row",42),e.YNc(39,lt,1,2,"mat-row",43),e.qZA(),e.YNc(40,rt,2,1,"div",44),e.YNc(41,st,2,2,"div",45),e._UZ(42,"mat-paginator",46,47),e.qZA()()()()()),2&t){const o=e.oxw();e.xp6(12),e.Q6J("dataSource",o.dataSource),e.xp6(26),e.Q6J("matHeaderRowDef",o.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns),e.xp6(1),e.Q6J("ngIf",null==o.exampleDatabase?null:o.exampleDatabase.isTblLoading),e.xp6(1),e.Q6J("ngIf",!(null!=o.exampleDatabase&&o.exampleDatabase.isTblLoading)),e.xp6(1),e.Q6J("length",o.datosFuente.length)("pageIndex",0)("pageSize",15)("pageSizeOptions",e.DdM(9,mt))}}const pt=function(){return[]};let ut=(()=>{class t{constructor(o,i,n,l,c,d,r,u){this.httpClient=o,this.dialog=i,this.appointmentsService=n,this.doctorsService=l,this.snackBar=c,this.router=d,this.fb=r,this.cdr=u,this.filterToggle=!1,this.displayedColumns=["name","dateTime","medic","email","mobile","estatus"],this.currentDate=(new Date).toISOString(),this.estatus=1,this.dataSource=new p.by,this.isTableVisible=!1,this.medics=[],this.minDate=new Date,this.allAppoinmentsForm=this.fb.group({medico:[,s.kI.required],fecha:["",s.kI.required]}),this.datosFuente=[],this.selection=new E.Ov(!0,[]),this.contextMenuPosition={x:"0px",y:"0px"},this.myFilter=C=>{const P=(C||new Date).getDay();return 0!==P&&6!==P},new p.by([])}ngOnInit(){this.loadData()}refresh(){this.loadData()}detailsCall(o){let i;i="true"===localStorage.getItem("isRtl")?"rtl":"ltr",this.dialog.open(S.U,{data:{appointments:o,action:"details"},direction:i,height:"71%",width:"35%"})}refreshTable(){this.paginator._changePageSize(this.paginator.pageSize)}getStatus(o){return"En espera"==o?"mat-primary":"En curso"==o?"mat-success":"mat-finish"}loadData(){this.doctorsService.getAllDoctorss().subscribe(o=>{this.medics=o.medicos})}redirect(o){v().fire({title:"\xbfDesea editar cita?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3f51b5",cancelButtonColor:"#d33",confirmButtonText:"Editar"}).then(i=>{i.isConfirmed&&this.router.navigateByUrl("admin/appointment/edit-appointment",{state:{idCita:o}})})}showNotification(o,i,n,l){this.snackBar.open(i,"",{duration:2e3,verticalPosition:n,horizontalPosition:l,panelClass:o})}campoEsValido(o){return this.allAppoinmentsForm.controls[o].errors&&this.allAppoinmentsForm.controls[o].touched}search(){if(!this.allAppoinmentsForm.valid)return void this.allAppoinmentsForm.markAllAsTouched();let o=new Date(this.allAppoinmentsForm.value.fecha).toISOString();this.appointmentsService.postAppoinmentsByDateAndMedic(this.allAppoinmentsForm.value.medico,o).subscribe(n=>{console.log(n,"click"),this.isTableVisible=!0,this.datosFuente=n.citas,console.log(this.datosFuente),this.dataSource=new p.by(this.datosFuente),this.cdr.detectChanges(),this.dataSource.paginator=this.paginator,this.datosFuente.forEach(l=>{l.fecha_cita=new Date(l.fecha_cita).toLocaleString()})})}onDateChange(o){console.log(o)}static#e=this.\u0275fac=function(i){return new(i||t)(e.Y36(y.eN),e.Y36(V.uw),e.Y36(g.O),e.Y36(T.e),e.Y36($.ux),e.Y36(Z.F0),e.Y36(s.qu),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-all-appoinments"]],viewQuery:function(i,n){if(1&i&&(e.Gf(b.NW,5),e.Gf(R.p6,5)),2&i){let l;e.iGM(l=e.CRH())&&(n.paginator=l.first),e.iGM(l=e.CRH())&&(n.contextMenu=l.first)}},features:[e._Bn([g.O,T.e])],decls:29,vars:13,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[3,"title","items","active_item"],[1,"row"],[1,"card"],[1,"header"],[1,"body"],[1,"example-container"],[3,"formGroup"],["appearance","outline",1,"col-4","me-3"],["formControlName","medico"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["appearance","outline",1,"col-4"],["matInput","","formControlName","fecha",3,"matDatepickerFilter","min","matDatepicker"],["matSuffix","",3,"for"],["picker",""],["mat-raised-button","","color","primary",1,"ms-4",3,"click"],["class","row",4,"ngIf"],[3,"value"],[1,"col-lg-12","col-md-12","col-sm-12","col-xs-12"],[1,"materialTableHeader"],[1,"left"],[1,"header-buttons-left","ms-0"],[1,"tbl-title"],[1,"right"],[1,"body","overflow-auto"],[1,"responsive_table"],["matSort","",1,"mat-cell",3,"dataSource"],["table",""],["matColumnDef","id"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","name"],["matColumnDef","dateTime"],["matColumnDef","medic"],["matColumnDef","mobile"],["matColumnDef","email"],["matColumnDef","address"],["class","column-nowrap",4,"matCellDef"],["matColumnDef","estatus"],[4,"matHeaderRowDef"],["matRipple","",3,"cursor","click",4,"matRowDef","matRowDefColumns"],["class","tbl-spinner",4,"ngIf"],["class","no-results",3,"display",4,"ngIf"],[3,"length","pageIndex","pageSize","pageSizeOptions"],["paginator",""],[1,"mobile-label"],[1,"column-nowrap"],["mat-raised-button","",3,"ngClass"],["matRipple","",3,"click"],[1,"tbl-spinner"],["color","primary","mode","indeterminate",3,"diameter"],[1,"no-results"]],template:function(i,n){if(1&i&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2),e._UZ(3,"app-breadcrumb",3),e.qZA(),e.TgZ(4,"div",4)(5,"div",5),e._UZ(6,"div",6),e.TgZ(7,"div",7)(8,"div",8)(9,"form",9)(10,"mat-form-field",10)(11,"mat-label"),e._uU(12,"Medico"),e.qZA(),e.TgZ(13,"mat-select",11),e.YNc(14,Ee,2,2,"mat-option",12),e.qZA(),e.YNc(15,Be,2,1,"mat-error",13),e.qZA(),e.TgZ(16,"mat-form-field",14)(17,"mat-label"),e._uU(18,"Fecha"),e.qZA(),e._UZ(19,"input",15)(20,"mat-datepicker-toggle",16)(21,"mat-datepicker",null,17),e.YNc(23,Re,2,1,"mat-error",13),e.qZA(),e.TgZ(24,"button",18),e.NdJ("click",function(){return n.search()}),e.TgZ(25,"mat-icon"),e._uU(26,"search"),e.qZA(),e._uU(27," Buscar "),e.qZA()()()()()(),e.YNc(28,ct,44,10,"div",19),e.qZA()()),2&i){const l=e.MAs(22);e.xp6(3),e.Q6J("title","Citas")("items",e.DdM(12,pt))("active_item","Todas las citas"),e.xp6(6),e.Q6J("formGroup",n.allAppoinmentsForm),e.xp6(5),e.Q6J("ngForOf",n.medics),e.xp6(1),e.Q6J("ngIf",n.campoEsValido("medico")),e.xp6(4),e.Q6J("matDatepickerFilter",n.myFilter)("min",n.minDate)("matDatepicker",l),e.xp6(1),e.Q6J("for",l),e.xp6(3),e.Q6J("ngIf",n.campoEsValido("fecha")),e.xp6(5),e.Q6J("ngIf",n.isTableVisible)}},dependencies:[f.mk,f.sg,f.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,x.L,A.ey,D.lW,_.Mq,_.hl,_.nW,h.KE,h.hX,h.TO,h.R9,M.Hw,U.Nt,b.NW,N.Ou,A.wG,F.gD,w.YE,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,Y.m]})}return t})();var dt=m(7884),ht=m(8319),ft=m(2596);function _t(t,a){if(1&t&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id_medico),e.xp6(1),e.hij(" ",o.nombre+" "+o.apellidos," ")}}function gt(t,a){1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&t&&(e.xp6(1),e.Oqu("Debe seleccionar un Medico"))}function vt(t,a){1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&t&&(e.xp6(1),e.Oqu("Debe seleccionar una fecha inicio"))}function At(t,a){1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&t&&(e.xp6(1),e.Oqu("Debe seleccionar una fecha fin"))}function Zt(t,a){if(1&t&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o),e.xp6(1),e.hij(" ",o," ")}}function Tt(t,a){1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&t&&(e.xp6(1),e.Oqu("Debe seleccionar el motivo de la consulta"))}function Ct(t,a){1&t&&(e.TgZ(0,"mat-header-cell",49),e._uU(1,"Paciente "),e.qZA())}function bt(t,a){if(1&t&&(e.TgZ(0,"mat-cell")(1,"span",50),e._uU(2,"Medico:"),e.qZA(),e._uU(3),e.qZA()),2&t){const o=a.$implicit;e.xp6(3),e.hij(" ",o.Paciente.nombre+" "+o.Paciente.apellidos," ")}}function xt(t,a){1&t&&(e.TgZ(0,"mat-header-cell",49),e._uU(1,"Motivo Consulta "),e.qZA())}function Dt(t,a){if(1&t&&(e.TgZ(0,"mat-cell")(1,"span",50),e._uU(2,"Motivo Consulta:"),e.qZA(),e._uU(3),e.qZA()),2&t){const o=a.$implicit;e.xp6(3),e.hij(" ",o.motivo_consulta," ")}}function wt(t,a){1&t&&(e.TgZ(0,"mat-header-cell",49),e._uU(1,"Fecha y Hora "),e.qZA())}function qt(t,a){if(1&t&&(e.TgZ(0,"mat-cell")(1,"span",50),e._uU(2,"Date & Time:"),e.qZA(),e._uU(3),e.ALo(4,"CustomDateTablePipe"),e.qZA()),2&t){const o=a.$implicit;e.xp6(3),e.hij(" ",e.lcZ(4,1,o.fecha_cita)," ")}}function Ut(t,a){1&t&&(e.TgZ(0,"mat-header-cell",49),e._uU(1,"Estatus "),e.qZA())}function Ft(t,a){if(1&t&&(e.TgZ(0,"mat-cell")(1,"span",50),e._uU(2,"Estatus:"),e.qZA(),e.TgZ(3,"button",51),e._uU(4),e.qZA()()),2&t){const o=a.$implicit,i=e.oxw(2);e.xp6(3),e.Q6J("ngClass",i.getStatus(o.estatus)),e.xp6(1),e.hij(" ",o.estatus," ")}}function St(t,a){1&t&&e._UZ(0,"mat-header-row")}function yt(t,a){1&t&&e._UZ(0,"mat-row",52),2&t&&e.Udp("cursor","pointer")}function Nt(t,a){1&t&&(e.TgZ(0,"div",53),e._UZ(1,"mat-progress-spinner",54),e.qZA()),2&t&&(e.xp6(1),e.Q6J("diameter",40))}function Yt(t,a){if(1&t&&(e.TgZ(0,"div",55),e._uU(1," Sin resultados "),e.qZA()),2&t){const o=e.oxw(2);e.Udp("display",0===o.dataSource.filteredData.length?"":"none")}}const kt=function(){return[5,10,25,100]};function Qt(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"div",23)(1,"div",24)(2,"div",5)(3,"div",25)(4,"div",26)(5,"ul",27)(6,"li",28)(7,"h2"),e._uU(8,"Citas"),e.qZA()()()(),e.TgZ(9,"div",29)(10,"ul",30)(11,"li")(12,"div",31)(13,"img",32),e.NdJ("click",function(){e.CHM(o);const n=e.oxw();return e.KtG(n.exportExcel())}),e.qZA()()()()()(),e.TgZ(14,"div",33)(15,"div",34)(16,"mat-table",35,36),e.ynx(18,37),e.YNc(19,Ct,2,0,"mat-header-cell",38),e.YNc(20,bt,4,1,"mat-cell",39),e.BQk(),e.ynx(21,40),e.YNc(22,xt,2,0,"mat-header-cell",38),e.YNc(23,Dt,4,1,"mat-cell",39),e.BQk(),e.ynx(24,41),e.YNc(25,wt,2,0,"mat-header-cell",38),e.YNc(26,qt,5,3,"mat-cell",39),e.BQk(),e.ynx(27,42),e.YNc(28,Ut,2,0,"mat-header-cell",38),e.YNc(29,Ft,5,2,"mat-cell",39),e.BQk(),e.YNc(30,St,1,0,"mat-header-row",43),e.YNc(31,yt,1,2,"mat-row",44),e.qZA(),e.YNc(32,Nt,2,1,"div",45),e.YNc(33,Yt,2,2,"div",46),e._UZ(34,"mat-paginator",47,48),e.qZA()()()()()}if(2&t){const o=e.oxw();e.xp6(16),e.Q6J("dataSource",o.dataSource),e.xp6(14),e.Q6J("matHeaderRowDef",o.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns),e.xp6(1),e.Q6J("ngIf",null==o.exampleDatabase?null:o.exampleDatabase.isTblLoading),e.xp6(1),e.Q6J("ngIf",!(null!=o.exampleDatabase&&o.exampleDatabase.isTblLoading)),e.xp6(1),e.Q6J("length",o.datosFuente.length)("pageIndex",0)("pageSize",15)("pageSizeOptions",e.DdM(9,kt))}}const Jt=function(){return[]},It=[{path:"bookAppointment",component:ie},{path:"viewAppointment",component:qe},{path:"edit-appointment",component:Oe},{path:"all-appointments",component:ut},{path:"appointments-report",component:(()=>{class t{constructor(o,i,n,l,c,d,r){this.fb=o,this.appoinmentsService=i,this.authService=n,this.doctorService=l,this.router=c,this.configurationService=d,this.cdr=r,this.BtngenerarExcel=!1,this.idMedico=0,this.reportForm=this.fb.group({startDate:[,s.kI.required],endDate:[,s.kI.required],type:[,s.kI.required],medico:[,s.kI.required]}),this.dataSource=new p.by,this.datosFuente=[],this.minDate=new Date,this.showTable=!1,this.doctors=[],this.motivos=[],this.displayedColumns=["name","motivo_consulta","fecha","status"],new p.by([])}ngOnInit(){this.configurationService.getMotivoConsulta().subscribe(o=>{this.motivos=o.motivoConsulta.map(i=>i.motivo_consulta)}),this.doctorService.getAllDoctorss().subscribe(o=>{this.doctors=o.medicos})}search(){if(!this.reportForm.valid)return void this.reportForm.markAllAsTouched();const o=new Date(this.reportForm.value.startDate),i=new Date(this.reportForm.value.endDate);i<o&&console.log("entro"),console.log(this.reportForm.value);const n={idMedico:this.reportForm.value.medico,startDate:o.toISOString(),endDate:i.toISOString(),type:this.reportForm.value.type};this.appoinmentsService.getAppoinmentsByDateAndType(n).subscribe(l=>{0!=l.citas.rows.length&&(this.datosFuente=l.citas.rows,this.dataSource=new p.by(this.datosFuente),this.showTable=!0,this.BtngenerarExcel=!0),this.cdr.detectChanges(),this.dataSource.paginator=this.paginator})}campoEsValido(o){return this.reportForm.controls[o].errors&&this.reportForm.controls[o].touched}exportExcel(){console.log(this.dataSource);const o=this.dataSource.filteredData.map(i=>({"Nombre Paciente":i.Paciente.nombre+" "+i.Paciente.apellidos,"Motivo Consulta":i.motivo_consulta,"Fecha Consulta":i.fecha_cita.split("T")[0]+" - "+i.fecha_cita.split("T")[1].substring(0,5),Estatus:i.estatus}));dt.c.exportToExcel(o,"excel")}getStatus(o){return"En espera"==o?"mat-primary":"En curso"==o?"mat-success":"mat-finish"}static#e=this.\u0275fac=function(i){return new(i||t)(e.Y36(s.qu),e.Y36(g.O),e.Y36(ht.e8),e.Y36(T.e),e.Y36(Z.F0),e.Y36(I.e),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-appoinments-report"]],viewQuery:function(i,n){if(1&i&&e.Gf(b.NW,5),2&i){let l;e.iGM(l=e.CRH())&&(n.paginator=l.first)}},features:[e._Bn([g.O,{provide:e.soG,useValue:"es-MX"}])],decls:42,vars:16,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[3,"title","items","active_item"],[1,"row"],[1,"card"],[1,"header"],[1,"body"],[1,"example-container"],[3,"formGroup"],["appearance","outline",1,"col-3"],["formControlName","medico"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["matInput","","formControlName","startDate",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],["matInput","","formControlName","endDate",3,"matDatepicker"],["picker1",""],["formControlName","type"],["mat-raised-button","","color","primary",1,"btn-space",3,"click"],["class","row","style","margin-top: 15px;",4,"ngIf"],[3,"value"],[1,"row",2,"margin-top","15px"],[1,"col-lg-12","col-md-12","col-sm-12","col-xs-12"],[1,"materialTableHeader"],[1,"left"],[1,"header-buttons-left","ms-0"],[1,"tbl-title"],[1,"right"],[1,"tbl-export-btn"],["matTooltip","XLSX",1,"export-button","m-l-10"],["src","assets/images/icons/xlsx.png","alt","",3,"click"],[1,"body","overflow-auto"],[1,"responsive_table"],["matSort","",1,"mat-cell",3,"dataSource"],["table",""],["matColumnDef","name"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","motivo_consulta"],["matColumnDef","fecha"],["matColumnDef","status"],[4,"matHeaderRowDef"],["matRipple","",3,"cursor",4,"matRowDef","matRowDefColumns"],["class","tbl-spinner",4,"ngIf"],["class","no-results",3,"display",4,"ngIf"],[3,"length","pageIndex","pageSize","pageSizeOptions"],["paginator",""],["mat-sort-header",""],[1,"mobile-label"],["mat-raised-button","",3,"ngClass"],["matRipple",""],[1,"tbl-spinner"],["color","primary","mode","indeterminate",3,"diameter"],[1,"no-results"]],template:function(i,n){if(1&i&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2),e._UZ(3,"app-breadcrumb",3),e.qZA(),e.TgZ(4,"div",4)(5,"div",5),e._UZ(6,"div",6),e.TgZ(7,"div",7)(8,"div",8)(9,"form",9)(10,"div",4)(11,"mat-form-field",10)(12,"mat-label"),e._uU(13,"Medico"),e.qZA(),e.TgZ(14,"mat-select",11),e.YNc(15,_t,2,2,"mat-option",12),e.qZA(),e.YNc(16,gt,2,1,"mat-error",13),e.qZA(),e.TgZ(17,"mat-form-field",10)(18,"mat-label"),e._uU(19,"Fecha Inicio"),e.qZA(),e._UZ(20,"input",14)(21,"mat-datepicker-toggle",15)(22,"mat-datepicker",null,16),e.YNc(24,vt,2,1,"mat-error",13),e.qZA(),e.TgZ(25,"mat-form-field",10)(26,"mat-label"),e._uU(27,"Fecha Fin"),e.qZA(),e._UZ(28,"input",17)(29,"mat-datepicker-toggle",15)(30,"mat-datepicker",null,18),e.YNc(32,At,2,1,"mat-error",13),e.qZA(),e.TgZ(33,"mat-form-field",10)(34,"mat-label"),e._uU(35,"Motivo Consulta"),e.qZA(),e.TgZ(36,"mat-select",19),e.YNc(37,Zt,2,2,"mat-option",12),e.qZA(),e.YNc(38,Tt,2,1,"mat-error",13),e.qZA()(),e.TgZ(39,"button",20),e.NdJ("click",function(){return n.search()}),e._uU(40,"Buscar"),e.qZA()()(),e.YNc(41,Qt,36,10,"div",21),e.qZA()()()()()),2&i){const l=e.MAs(23),c=e.MAs(31);e.xp6(3),e.Q6J("title","Citas")("items",e.DdM(15,Jt))("active_item","Calendario"),e.xp6(6),e.Q6J("formGroup",n.reportForm),e.xp6(6),e.Q6J("ngForOf",n.doctors),e.xp6(1),e.Q6J("ngIf",n.campoEsValido("medico")),e.xp6(4),e.Q6J("matDatepicker",l),e.xp6(1),e.Q6J("for",l),e.xp6(3),e.Q6J("ngIf",n.campoEsValido("startDate")),e.xp6(4),e.Q6J("matDatepicker",c),e.xp6(1),e.Q6J("for",c),e.xp6(3),e.Q6J("ngIf",n.campoEsValido("endDate")),e.xp6(5),e.Q6J("ngForOf",n.motivos),e.xp6(1),e.Q6J("ngIf",n.campoEsValido("type")),e.xp6(3),e.Q6J("ngIf",n.showTable)}},dependencies:[f.mk,f.sg,f.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,x.L,A.ey,D.lW,_.Mq,_.hl,_.nW,h.KE,h.hX,h.TO,h.R9,U.Nt,b.NW,N.Ou,A.wG,F.gD,w.YE,w.nU,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,ft.gM,Y.m],styles:[".mat-success[_ngcontent-%COMP%]{background-color:green;color:#fff}"]})}return t})()},{path:"**",component:Me.J}];let Ot=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=e.oAB({type:t});static#o=this.\u0275inj=e.cJS({imports:[Z.Bz.forChild(It),Z.Bz]})}return t})();var Mt=m(5619);let Et=(()=>{class t extends B.n{constructor(o){super(),this.httpClient=o,this.API_URL="assets/data/appointment.json",this.isTblLoading=!0,this.dataChange=new Mt.X([])}get data(){return this.dataChange.value}getDialogData(){return this.dialogData}getAllAppointments(){this.subs.sink=this.httpClient.get(this.API_URL).subscribe({next:o=>{this.isTblLoading=!1,this.dataChange.next(o)},error:o=>{this.isTblLoading=!1,console.log(o.name+" "+o.message)}})}addAppointment(o){this.dialogData=o}updateAppointment(o){this.dialogData=o}deleteAppointment(o){console.log(o)}static#e=this.\u0275fac=function(i){return new(i||t)(e.LFG(y.eN))};static#t=this.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac})}return t})();var Bt=m(1858),Rt=m(121);let Vt=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=e.oAB({type:t});static#o=this.\u0275inj=e.cJS({providers:[Et],imports:[f.ez,Ot,s.u5,s.UX,Bt.K,Rt.m]})}return t})()}}]);